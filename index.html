<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Museum Pikiran Acak</title>
  <style>
    body {
      margin: 0;
      font-family: 'Georgia', serif;
      background: linear-gradient(120deg, #f7f3ef, #ece6df);
      color: #2e2e2e;
      min-height: 100vh;
    }

    .container {
      max-width: 700px;
      margin: auto;
      padding: 40px 20px;
    }

    h1 {
      text-align: center;
      font-weight: normal;
      letter-spacing: 1px;
      margin-bottom: 10px;
    }

    .subtitle {
      text-align: center;
      font-size: 14px;
      opacity: 0.7;
      margin-bottom: 30px;
    }

    .card {
      background: rgba(255,255,255,0.9);
      padding: 25px;
      border-radius: 16px;
      margin-top: 25px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.08);
    }

    .question-selector {
      margin-bottom: 20px;
    }

    .question-selector label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      font-size: 14px;
    }

    select {
      width: 100%;
      padding: 12px;
      border-radius: 10px;
      border: 1px solid #ccc;
      font-family: inherit;
      font-size: 15px;
      background: white;
      cursor: pointer;
    }

    .question {
      font-size: 18px;
      margin: 20px 0 15px 0;
      font-style: italic;
      color: #444;
      padding: 15px;
      background: rgba(0,0,0,0.02);
      border-radius: 8px;
    }

    textarea {
      width: 100%;
      padding: 12px;
      border-radius: 10px;
      border: 1px solid #ccc;
      resize: vertical;
      font-family: inherit;
      font-size: 15px;
      box-sizing: border-box;
    }

    .button-group {
      display: flex;
      gap: 10px;
      margin-top: 15px;
      flex-wrap: wrap;
    }

    button {
      padding: 12px 24px;
      border: none;
      border-radius: 20px;
      background: #2e2e2e;
      color: white;
      cursor: pointer;
      font-size: 15px;
      transition: all 0.3s;
    }

    button:hover {
      background: #1a1a1a;
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }

    .btn-secondary {
      background: #666 !important;
    }

    .btn-delete {
      background: #dc3545;
      padding: 8px 12px;
      font-size: 12px;
      margin-top: 8px;
    }

    .btn-delete:hover {
      background: #c82333;
    }

    .thought {
      font-size: 15px;
      border-left: 3px solid #aaa;
      padding-left: 12px;
      margin-top: 15px;
      padding-top: 10px;
      padding-bottom: 10px;
      line-height: 1.6;
      position: relative;
    }

    .thought-question {
      font-size: 13px;
      color: #666;
      font-style: italic;
      margin-bottom: 5px;
    }

    .thought-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 8px;
    }

    .delete-btn {
      background: #dc3545;
      color: white;
      border: none;
      padding: 5px 12px;
      border-radius: 5px;
      font-size: 12px;
      cursor: pointer;
      margin-top: 8px;
    }

    .delete-btn:hover {
      background: #c82333;
    }

    .random-question-btn {
      background: #6c757d;
      margin-left: 10px;
    }

    .random-mode {
      margin-top: 15px;
      padding: 10px;
      background: rgba(0,0,0,0.03);
      border-radius: 8px;
      font-size: 14px;
      color: #666;
    }

    .button-group {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .btn-secondary {
      background: #6c757d;
    }

    .btn-secondary:hover {
      background: #5a6268;
    }
  </style>
</head>
<body>

<div class="container">
  <h1>üß† Museum Pikiran Acak</h1>
  <div class="subtitle">Ruang untuk pikiran yang tidak perlu dimengerti, hanya perlu ditaruh.</div>

  <div class="card">
    <div class="question-selector">
      <label>Pilih Pertanyaan:</label>
      <select id="questionSelect" onchange="updateQuestion()">
        <option value="">-- Pilih pertanyaan yang kamu mau jawab --</option>
      </select>
    </div>

    <div class="question" id="question">Pilih pertanyaan di atas untuk mulai...</div>
    
    <textarea id="answer" rows="5" placeholder="Tulis pikiranmu di sini..."></textarea>
    <button onclick="saveThought()">Simpan Pikiran</button>
    <button onclick="saveRandomThought()" style="background: #666; margin-left: 10px;">Simpan Pikiran Acak</button>
    <div class="success-message" id="successMsg">‚úì Pikiranmu telah disimpan</div>
  </div>

  <div class="card">
    <h3>Pikiran yang Pernah Dititipkan</h3>
    <div id="thoughts">
      <div class="empty-state">Belum ada pikiran yang dititipkan. Jadilah yang pertama.</div>
    </div>
  </div>

  <footer>
    Tidak semua pikiran ingin dimengerti. Beberapa hanya ingin ditaruh.
  </footer>
</div>

<script>
  const questions = [
    "Hal kecil apa yang diam-diam bikin kamu sedih?",
    "Kapan terakhir kali kamu pura-pura kuat?",
    "Apa yang ingin kamu tinggalkan di tahun ini?",
    "Kalau tidak takut dihakimi, apa yang ingin kamu katakan?",
    "Siapa versi dirimu yang paling kamu rindukan?",
    "Hal apa yang sering kamu pikirkan sebelum tidur?",
    "Apa yang tidak pernah kamu ceritakan ke siapa pun?",
    "Apa arti pulang bagimu?",
    "Siapa yang ingin kamu maafkan tapi belum sanggup?",
    "Apa yang ingin kamu lindungi dalam hidupmu?",
    "Kalau hidup bukan lomba, kamu ingin jalan seberapa pelan?",
    "Apa yang membuatmu tetap bertahan sejauh ini?",
    "Apa yang kamu harap orang lain pahami tentangmu?",
    "Hal apa yang membuatmu merasa cukup?",
    "Apa versi bahagia menurutmu?",
    "Kalimat apa yang ingin kamu dengar hari ini?",
    "Apa yang sering kamu pendam tapi ingin dilepaskan?",
    "Apa yang ingin kamu katakan ke dirimu 5 tahun lalu?",
    "Siapa yang paling sering kamu rindukan diam-diam?",
    "Apa yang sedang kamu perjuangkan tanpa sorak?"
  ];

  const questionEl = document.getElementById("question");
  const questionSelect = document.getElementById("questionSelect");
  const thoughtsEl = document.getElementById("thoughts");
  const answerEl = document.getElementById("answer");
  const successMsg = document.getElementById("successMsg");

  let thoughts = [];

  // Load thoughts from storage on init
  async function loadThoughts() {
    try {
      const result = await window.storage.get('museum_thoughts');
      if (result && result.value) {
        thoughts = JSON.parse(result.value);
        displayThoughts();
      }
    } catch (error) {
      console.log('No saved thoughts yet');
    }
  }

  // Save thoughts to storage
  async function saveToStorage() {
    try {
      await window.storage.set('museum_thoughts', JSON.stringify(thoughts));
    } catch (error) {
      console.error('Failed to save:', error);
    }
  }

  // Populate question dropdown
  function initQuestions() {
    questions.forEach((q, index) => {
      const option = document.createElement("option");
      option.value = index;
      option.textContent = q;
      questionSelect.appendChild(option);
    });
  }

  function updateQuestion() {
    const selectedIndex = questionSelect.value;
    if (selectedIndex !== "") {
      questionEl.textContent = questions[selectedIndex];
      answerEl.focus();
    } else {
      questionEl.textContent = "Pilih pertanyaan di atas untuk mulai...";
    }
  }

  async function saveThought() {
    const answer = answerEl.value.trim();
    const selectedIndex = questionSelect.value;
    
    if (!answer) {
      alert("Tulis pikiranmu dulu ya ü§ç");
      return;
    }

    let questionText;
    if (selectedIndex === "") {
      questionText = null; // Pikiran acak tanpa pertanyaan
    } else {
      questionText = questions[selectedIndex];
    }

    const thought = {
      question: questionText,
      answer: answer,
      date: new Date().toLocaleString('id-ID'),
      id: Date.now()
    };

    thoughts.unshift(thought);
    await saveToStorage();
    
    // Clear form
    answerEl.value = "";
    questionSelect.value = "";
    questionEl.textContent = "Pilih pertanyaan di atas untuk mulai...";
    
    // Show success message
    successMsg.style.display = "block";
    setTimeout(() => {
      successMsg.style.display = "none";
    }, 3000);
    
    displayThoughts();
  }

  async function deleteThought(id) {
    if (confirm('Yakin ingin menghapus pikiran ini?')) {
      thoughts = thoughts.filter(t => t.id !== id);
      await saveToStorage();
      displayThoughts();
    }
  }

  function displayThoughts() {
    thoughtsEl.innerHTML = "";
    
    if (thoughts.length === 0) {
      thoughtsEl.innerHTML = '<div class="empty-state">Belum ada pikiran yang dititipkan. Jadilah yang pertama.</div>';
      return;
    }
    
    thoughts.slice(0, 20).forEach(t => {
      const div = document.createElement("div");
      div.className = "thought";
      
      let content = '';
      if (t.question) {
        content = `<div class="thought-question">"${t.question}"</div>`;
      } else {
        content = `<div class="thought-question">‚ú® Pikiran acak</div>`;
      }
      
      content += `
        <div>${t.answer}</div>
        <button class="delete-btn" onclick="deleteThought(${t.id})">üóëÔ∏è Hapus</button>
      `;
      
      div.innerHTML = content;
      thoughtsEl.appendChild(div);
    });
  }

  // Initialize
  initQuestions();
  loadThoughts();
</script>

</body>
</html>